<!DOCTYPE html>
<html>
<body>
  <h1>Control de Luz</h1>
  <button onclick="sendCommand('ON')">Encender LED</button>
  <button onclick="sendCommand('OFF')">Apagar LED</button>
  <h2>Temperatura:</h2>
  <div id="datos"></div>

  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <script>
    // Conectar al broker MQTT (WebSocket)
    const client = mqtt.connect("wss://test.mosquitto.org:8081/mqtt");

    // Suscribirse al tópico de temperatura
    client.subscribe("casa/sala/temperatura");

    // Manejar mensajes recibidos
    client.on("message", (topic, message) => {
      if (topic === "casa/sala/temperatura") {
        document.getElementById("datos").innerHTML = `Temperatura: ${message}°C`;
      }
    });

    // Enviar comando al ESP8266
    function sendCommand(cmd) {
      client.publish("casa/sala/luz", cmd);
    }
  </script>
</body>
</html>
